properties([
    parameters([
        choice (
            choices: ['','validate_files','docker-build','ec2-build','Run_custom_scipt'],
            description: 'enter the job to run',
            name: 'Job_Type'
        ),
        choice (
            choices: ['','v1','v2', 'v3'],
            description: 'Choose your version',
            name: 'versions'
        )
    ])
])



pipeline {
    agent any

    stages {
        stage('validate') {
            when {
                expression { params.Job_Type == 'validate_files' }
            }
            steps {
                echo 'validating file..'
            }
        }
        stage('docker-build') {
            when {
                expression { params.Job_Type == 'docker-build' }
            }
            steps {
                sh '''

                echo 'building docker from docker file'
                cd sandeep &&
                docker build -t jenkins .

                '''
            }
        }
        stage('ec2-build') {
            when {
                expression { params.Job_Type == 'ec2-build' }
            }
            steps {
                sh '''
                
                echo 'describing ec2 instance....'
                cd santosh &&
                ls -ltr
                pwd
                sh buildec2.sh

                '''
            }
        }
        stage('custom_script') {
            when {
                expression { params.Job_Type == 'Run_custom_scipt' }
            }
            steps {
                sh '''
                pwd
                ls -ltr
                chmod 400 giriraj/dev_workstation_2.pem
                ssh -o "StrictHostKeyChecking no" -i giriraj/dev_workstation_2.pem ubuntu@52.91.21.237 'bash -s' < giriraj/config.sh            
                '''
            }
        }
    }
}
